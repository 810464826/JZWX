<!--[arg _res,staticPath,basePath,wxuser,vip;]-->
<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<title>我&nbsp;&nbsp;的&nbsp;&nbsp;粮&nbsp;&nbsp;仓</title>
<meta name="viewport"
	content="width=device-width, initial-scale=1,maximum-scale=1,minimum-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta content="telephone=no" name="format-detection">
<link rel="stylesheet" href="${staticPath}/front/css/my.css" />
<script type="text/javascript"
	src="${staticPath}/front/js/jquery-3.1.0.min.js"></script>
<script type="text/javascript" src="${staticPath}/front/js/jquery-ui.js"></script>
</head>

<body>
	<!--页面-->
	<header>
		<div id="header-info">
			<div id="head-portrait" class="header-public-style">
				<img src="${wxuser.getHeadimgurl()}" alt="" />
			</div>
			<div id="head-font" class="header-public-style">
				<input type="hidden" id="codename" value="${wxuser.getNickname()}" />
				<div id="username">
					<span id="name"></span>
				</div>
				<div class="total-info">
					总粮食：<em id="total-weight">${vip.getAllIntegral()}</em><span>&nbsp;克</span>
				</div>
			</div>

			<a id="sign"><button class="header-public-style">签到</button></a>

		</div>
		<div id="line"></div>
		<div id="container">
			<ul>
				<li><a href="#">
						<div class="weight">${vip.getWhrat()}</div> <img
						src="${staticPath}/front/images/my/wheat.png" alt="" />
						<div>小麦</div>
				</a></li>
				<li><a href="#">
						<div class="weight">${vip.getRice()}</div> <img
						src="${staticPath}/front/images/my/rice.png" alt="" />
						<div>大米</div>
				</a></li>
				<li><a href="#">
						<div class="weight">${vip.getCorn()}</div> <img
						src="${staticPath}/front/images/my/maize.png" alt="" />
						<div>玉米</div>
				</a></li>
				<li><a href="#">
						<div class="weight">${vip.getSorghum()}</div> <img
						src="${staticPath}/front/images/my/sorghum.png" alt="" />
						<div>高粱</div>
				</a></li>
				<li><a href="#">
						<div class="weight">${vip.getGlutinousrice()}</div> <img
						src="${staticPath}/front/images/my/stickyRice.png" alt="" />
						<div>糯米</div>
				</a></li>
			</ul>
		</div>
	</header>
	<section>
		<ul
			style="background-image: url('${staticPath}/front/images/my/bg-white.png')">
			<li class="section"><a href="/JZWX/scancode"><img
					src="${staticPath}/front/images/my/SweepBaby.jpg" alt="" /></a> <a
				href="/JZWX/foodExchange"><img
					src="${staticPath}/front/images/my/foodExchange.jpg" alt="" /></a> <a
				href="/JZWX/myTurnplate"><img
					src="${staticPath}/front/images/my/RotaryBaby.jpg" alt="" /></a></li>
			<li class="section"><a><img id="address"
					src="${staticPath}/front/images/my/receiverAddress.jpg" alt="" /></a>
			</li>
		</ul>
	</section>
	<fooder>
	<div id="footer-container">
		<a href="" class='active'> <img
			src="${staticPath}/front/images/my/logoMy.png" alt="" />
			<div>我的</div>
		</a> <a href="/JZWX/exchangeMain"> <img
			src="${staticPath}/front/images/my/logoexchange.png" alt="" />
			<div>兑换</div>
		</a> <a href="/JZWX/luckDraw"> <img src="${staticPath}/front/images/my/coujiang.png"
			alt="" />
			<div>抽奖</div>
		</a>
	</div>
	</fooder>
	<!--弹窗-->
	<div id="popup" style="display: none">
		<div class="fade"></div>
		<div class="succ-pop">
			<h3 class="title">
				<span>中间填写内容</span>
			</h3>
			<div class="succ-pop-line"></div>
			<h3 class="confirm">确定</h3>
		</div>
	</div>
</body>
<script>!function(a){function b(){var b=g.getBoundingClientRect().width;b/c>640&&(b=640*c),a.rem=b/16,g.style.fontSize=a.rem+"px"}var c,d,e,f=a.document,g=f.documentElement,h=f.querySelector('meta[name="viewport"]'),i=f.querySelector('meta[name="flexible"]');if(h){var j=h.getAttribute("content").match(/initial-scale=(["']?)([d.]+)1?/);j&&(d=parseFloat(j[2]),c=parseInt(1/d))}else if(i){var j=i.getAttribute("content").match(/initial-dpr=(["']?)([d.]+)1?/);j&&(c=parseFloat(j[2]),d=parseFloat((1/c).toFixed(2)))}if(!c&&!d){var k=(a.navigator.appVersion.match(/android/gi),a.navigator.appVersion.match(/iphone/gi)),c=a.devicePixelRatio;c=k?c>=3?3:c>=2?2:1:1,d=1/c}if(g.setAttribute("data-dpr",c),!h)if(h=f.createElement("meta"),h.setAttribute("name","viewport"),h.setAttribute("content","initial-scale="+d+", maximum-scale="+d+", minimum-scale="+d+", user-scalable=no"),g.firstElementChild)g.firstElementChild.appendChild(h);else{var l=f.createElement("div");l.appendChild(h),f.write(l.innerHTML)}a.dpr=c,a.addEventListener("resize",function(){clearTimeout(e),e=setTimeout(b,300)},!1),a.addEventListener("pageshow",function(a){a.persisted&&(clearTimeout(e),e=setTimeout(b,300))},!1),"complete"===f.readyState?f.body.style.fontSize=12*c+"px":f.addEventListener("DOMContentLoaded",function(){f.body.setAttribute('fontSize',12*c+"px")},!1),b()}(window); </script>
<script type="text/javascript" src="${staticPath}/front/js/my.js"></script>
<script type="text/javascript"
	src="https://res.wx.qq.com/open/js/jweixin-1.1.0.js "></script>
<script type="text/javascript"
	src="http://res.wx.qq.com/open/js/jweixin-1.1.0.js"></script>
<script type="text/javascript">



		$("#name").text(decodeURI($("#codename").val()));
		$(document).ready(function(){
			$.ajax({
				type: "GET",
				url: "/JZWX/harvestAddress",
				async: true,
				dataType: "json",
				data: {"href":location.href},
				success: function(data){
					wx.config({
			              debug : false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
			              appId : data.appId, // 必填，公众号的唯一标识
			              timestamp : data.timestamp, // 必填，生成签名的时间戳
			              nonceStr : data.nonceStr, // 必填，生成签名的随机串
			              signature : data.signature,// 必填，签名，见附录1
			              jsApiList : ['openAddress']// 必填，需要使用的JS接口列表，所有JS接口列表见附录2
			         });
					wx.ready(function () {
						document.querySelector('#address').onclick = function (){ 
							wx.openAddress({
							     success: function () { 
							     },
							     cancel: function (esg) { 
							          // 用户取消拉出地址
									 alert(esg);
								}
							 });
						} 
				   	});
					wx.error(function (res) {
				   		alert(res.errMsg);
				   	});
				},
				error: function(){
						alert("获取地理位置出错");
					}
			});
		})
		$("#sign").click(function(){
			$.ajax({
				type: "GET",
				url: "/JZWX/mygranary/Report",
				async: true,
				dataType: "json",
				data: "",
				success: function(data){
					if(data.result){
						alert("签到成功!");
					}else{
						alert("已签过了，请明天再来!");
					};
					$("#total-weight").text(data.integralnumber);
				},
				error: function(){
					alert("出错");
				}
			});
		})
		</script>

</html>